# HTTP Book - Authentication & Password Scenarios
# @name auth_password_tests
# Update `baseUrl`, credentials, and tokens as needed before executing the requests.

@baseUrl = http://localhost:3000

### Login - happy path
# Use valid credentials to authenticate and capture the returned access token.
POST {{baseUrl}}/api/auth/login
content-type: application/json

{
  "email": "abidi.mahyar@gmail.com",
  "password": "Mm123456"
}

### Login - missing email or password (expect 400)
POST {{baseUrl}}/api/auth/login
content-type: application/json

{
  "email": "",
  "password": ""
}

### Login - invalid credentials (expect 401)
POST {{baseUrl}}/api/auth/login
content-type: application/json

{
  "email": "abidi.mahyar@gmail.com",
  "password": "WrongPassword123"
}

### Change password - happy path
# Replace Authorization header with a valid Bearer token.
POST {{baseUrl}}/api/auth/password/change
content-type: application/json
authorization: Bearer {{accessToken}}

{
  "currentPassword": "Mm123456",
  "newPassword": "NewPassword!123"
}

### Change password - missing fields (expect 400)
POST {{baseUrl}}/api/auth/password/change
content-type: application/json
authorization: Bearer {{accessToken}}

{
  "currentPassword": "",
  "newPassword": ""
}

### Change password - incorrect current password (expect 401)
POST {{baseUrl}}/api/auth/password/change
content-type: application/json
authorization: Bearer {{accessToken}}

{
  "currentPassword": "WrongPassword123",
  "newPassword": "NewPassword!123"
}

